2025-09-14 21:42:21,703 - INFO - üî• H100 SIMPLE TRAINING - 5 EPOCHS
2025-09-14 21:42:21,703 - INFO - ==================================================
2025-09-14 21:42:22,386 - INFO - ‚úÖ GPU detected: cuda:0
2025-09-14 21:42:22,386 - INFO -    Device: H100 80GB HBM3
2025-09-14 21:42:22,387 - INFO - 
üìä Configuration:
2025-09-14 21:42:22,387 - INFO -    Epochs: 5
2025-09-14 21:42:22,387 - INFO -    Batch size: 32
2025-09-14 21:42:22,387 - INFO -    Learning rate: 0.001
2025-09-14 21:42:22,387 - INFO -    Samples: 1000
2025-09-14 21:42:22,387 - INFO - 
üì¶ Generating synthetic data...
2025-09-14 21:42:24,042 - INFO -    Train samples: 800
2025-09-14 21:42:24,042 - INFO -    Test samples: 200
2025-09-14 21:42:24,042 - INFO - 
üèóÔ∏è Initializing model...
2025-09-14 21:42:25,466 - INFO - 
üöÄ Starting H100 training...
2025-09-14 21:42:25,466 - INFO - ==================================================
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/teamspace/studios/this_studio/CPC-SNN-GW/h100_simple_train.py", line 232, in <module>
    sys.exit(main())
  File "/teamspace/studios/this_studio/CPC-SNN-GW/h100_simple_train.py", line 188, in main
    state, loss, acc = train_step(state, batch_x, batch_y)
  File "/teamspace/studios/this_studio/CPC-SNN-GW/h100_simple_train.py", line 145, in train_step
    (loss, logits), grads = grad_fn(state.params)
  File "/teamspace/studios/this_studio/CPC-SNN-GW/h100_simple_train.py", line 141, in loss_wrapper
    loss, logits = loss_fn(params, batch_x, batch_y, training=True)
  File "/teamspace/studios/this_studio/CPC-SNN-GW/h100_simple_train.py", line 133, in loss_fn
    logits = state.apply_fn(params, batch_x, training=training)
  File "/teamspace/studios/this_studio/CPC-SNN-GW/h100_simple_train.py", line 61, in __call__
    x = nn.Dropout(0.2, deterministic=not training)(x)
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/flax/linen/stochastic.py", line 101, in __call__
    rng = self.make_rng(self.rng_collection)
flax.errors.InvalidRngError: Dropout_0 needs PRNG for "dropout" (https://flax.readthedocs.io/en/latest/api_reference/flax.errors.html#flax.errors.InvalidRngError)

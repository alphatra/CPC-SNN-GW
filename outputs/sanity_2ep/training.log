[2025-08-10 15:27:59,992] INFO [__main__:988] Forcing CPU backend as requested by --device=cpu
[2025-08-10 15:27:59,994] INFO [__main__:1000] 🚀 Starting CPC+SNN training (v0.1.dev2+g95217e9.d20250716)
[2025-08-10 15:27:59,995] INFO [__main__:1001]    Output directory: outputs/sanity_2ep
[2025-08-10 15:27:59,996] INFO [__main__:1002]    Configuration: configs/final_framework_config.yaml
[2025-08-10 15:27:59,997] INFO [__main__:1005] 🔧 Configuring JAX GPU settings...
[2025-08-10 15:28:00,076] INFO [__main__:1011] 🔧 Applying performance optimizations (startup)
[2025-08-10 15:28:00,086] INFO [utils.config:36] ✅ Applying runtime performance optimizations...
[2025-08-10 15:28:06,661] INFO [utils.config:60] JAX platform: gpu
[2025-08-10 15:28:06,661] INFO [utils.config:61] JAX devices: [CudaDevice(id=0)]
[2025-08-10 15:28:06,662] INFO [utils.config:62] Memory fraction: 0.35
[2025-08-10 15:28:06,663] INFO [utils.config:68] System memory: 16.7GB total, 15.7GB available
[2025-08-10 15:28:06,663] INFO [__main__:1016] 🔧 Pre-compiling models (startup)
[2025-08-10 15:28:06,664] INFO [utils.config:114] ⏭️ Skipping JIT pre-compilation on dummy inputs (user preference)
[2025-08-10 15:28:06,665] INFO [__main__:1039] 🔥 Performing COMPREHENSIVE GPU warmup to eliminate timing issues...
[2025-08-10 15:28:08,478] INFO [__main__:1044]    🔸 Stage 1: Basic tensor operations...
[2025-08-10 15:28:14,562] INFO [__main__:1052]    🔸 Stage 2: Dense layer operations...
[2025-08-10 15:28:18,300] INFO [__main__:1062]    🔸 Stage 3: CPC/SNN operations...
[2025-08-10 15:28:21,980] INFO [__main__:1080]    🔸 Stage 4: Advanced CUDA kernels...
[2025-08-10 15:28:24,898] INFO [__main__:1093]    🔸 Stage 5: JAX JIT compilation warmup...
[2025-08-10 15:28:25,286] INFO [__main__:1107]    🔸 Stage 6: SpikeBridge/CPC specific warmup...
[2025-08-10 15:28:35,016] INFO [__main__:1132] ✅ COMPREHENSIVE GPU warmup completed - ALL CUDA kernels initialized!
[2025-08-10 15:28:35,016] INFO [__main__:1139] 🎯 GPU devices available: 1
[2025-08-10 15:28:35,043] INFO [utils.config:444] Adding default enhanced W&B configuration
[2025-08-10 15:28:35,044] INFO [utils.config:447] Loaded configuration from configs/final_framework_config.yaml
[2025-08-10 15:28:35,045] INFO [__main__:1154] ✅ Loaded configuration from configs/final_framework_config.yaml
[2025-08-10 15:28:35,063] INFO [utils.config:479] Configuration saved to outputs/sanity_2ep/config.yaml
[2025-08-10 15:28:35,064] INFO [__main__:1181] 💾 Saved configuration to outputs/sanity_2ep/config.yaml
[2025-08-10 15:28:35,065] INFO [__main__:1185] 🎯 Starting standard training mode...
[2025-08-10 15:28:35,065] INFO [__main__:1192] 📋 Configuration loaded: cpu device, 128 latent dim
[2025-08-10 15:28:35,066] INFO [__main__:1193] 📋 Spike encoding: phase_preserving
[2025-08-10 15:28:35,067] INFO [__main__:1194] 📋 SNN hidden size: 512
[2025-08-10 15:28:35,068] INFO [__main__:1201] 🔧 Running standard CPC+SNN training...
[2025-08-10 15:28:35,093] INFO [utils.device_auto_detection:201] 🔍 Starting intelligent device detection...
[2025-08-10 15:28:35,095] INFO [utils.device_auto_detection:51] PyTorch not available for GPU detection
[2025-08-10 15:28:35,096] INFO [utils.device_auto_detection:62] JAX devices detected: [CudaDevice(id=0)]
[2025-08-10 15:28:35,097] INFO [utils.device_auto_detection:123] 🔋 STANDARD CPU: 16 cores, 15.6GB RAM
[2025-08-10 15:28:35,098] INFO [utils.device_auto_detection:137] 🔧 Applying optimal device configuration...
[2025-08-10 15:28:35,098] INFO [utils.device_auto_detection:138]    Platform: cpu
[2025-08-10 15:28:35,099] INFO [utils.device_auto_detection:139]    Memory fraction: 0.4
[2025-08-10 15:28:35,100] INFO [utils.device_auto_detection:140]    Recommended batch size: 1
[2025-08-10 15:28:35,101] INFO [utils.device_auto_detection:141]    Expected speedup: 1.0x
[2025-08-10 15:28:35,103] INFO [utils.device_auto_detection:162] ✅ JAX configured successfully:
[2025-08-10 15:28:35,104] INFO [utils.device_auto_detection:163]    Platform: gpu
[2025-08-10 15:28:35,105] INFO [utils.device_auto_detection:164]    Devices: [CudaDevice(id=0)]
[2025-08-10 15:28:35,106] INFO [utils.device_auto_detection:167] 🚀 GPU ACCELERATION ACTIVE - Expected 1.0x speedup!
[2025-08-10 15:28:35,107] INFO [utils.device_auto_detection:215] ✅ Device auto-detection and optimization complete!
[2025-08-10 15:28:35,108] INFO [utils.device_auto_detection:216] 💡 TIP: Your system is optimized for CPU training
[2025-08-10 15:28:35,108] INFO [__main__:57] 🎮 Platform detected: CPU
[2025-08-10 15:28:35,109] INFO [__main__:58] ⚡ Expected speedup: 1.0x
[2025-08-10 15:28:35,112] INFO [__main__:85] 🔧 Real CPC+SNN training pipeline:
[2025-08-10 15:28:35,113] ERROR [__main__:563] Standard training failed: 'cpc_latent_dim'
[2025-08-10 15:28:35,124] ERROR [__main__:1226] ❌ Training failed!
[2025-08-10 15:34:31,080] INFO [__main__:995] Forcing CPU backend as requested by --device=cpu
[2025-08-10 15:34:31,080] INFO [__main__:1007] 🚀 Starting CPC+SNN training (v0.1.dev2+g95217e9.d20250716)
[2025-08-10 15:34:31,081] INFO [__main__:1008]    Output directory: outputs/sanity_2ep
[2025-08-10 15:34:31,081] INFO [__main__:1009]    Configuration: configs/final_framework_config.yaml
[2025-08-10 15:34:31,082] INFO [__main__:1012] 🔧 Configuring JAX GPU settings...
[2025-08-10 15:34:31,100] INFO [__main__:1018] 🔧 Applying performance optimizations (startup)
[2025-08-10 15:34:31,100] INFO [utils.config:36] ✅ Applying runtime performance optimizations...
[2025-08-10 15:34:34,414] INFO [utils.config:60] JAX platform: gpu
[2025-08-10 15:34:34,415] INFO [utils.config:61] JAX devices: [CudaDevice(id=0)]
[2025-08-10 15:34:34,415] INFO [utils.config:62] Memory fraction: 0.35
[2025-08-10 15:34:34,416] INFO [utils.config:68] System memory: 16.7GB total, 15.7GB available
[2025-08-10 15:34:34,416] INFO [__main__:1023] 🔧 Pre-compiling models (startup)
[2025-08-10 15:34:34,417] INFO [utils.config:114] ⏭️ Skipping JIT pre-compilation on dummy inputs (user preference)
[2025-08-10 15:34:34,417] INFO [__main__:1046] 🔥 Performing COMPREHENSIVE GPU warmup to eliminate timing issues...
[2025-08-10 15:34:35,668] INFO [__main__:1051]    🔸 Stage 1: Basic tensor operations...
[2025-08-10 15:34:41,860] INFO [__main__:1059]    🔸 Stage 2: Dense layer operations...
[2025-08-10 15:34:45,682] INFO [__main__:1069]    🔸 Stage 3: CPC/SNN operations...
[2025-08-10 15:34:49,795] INFO [__main__:1087]    🔸 Stage 4: Advanced CUDA kernels...
[2025-08-10 15:34:52,333] INFO [__main__:1100]    🔸 Stage 5: JAX JIT compilation warmup...
[2025-08-10 15:34:52,710] INFO [__main__:1114]    🔸 Stage 6: SpikeBridge/CPC specific warmup...
[2025-08-10 15:35:01,947] INFO [__main__:1139] ✅ COMPREHENSIVE GPU warmup completed - ALL CUDA kernels initialized!
[2025-08-10 15:35:01,948] INFO [__main__:1146] 🎯 GPU devices available: 1
[2025-08-10 15:35:01,970] INFO [utils.config:444] Adding default enhanced W&B configuration
[2025-08-10 15:35:01,972] INFO [utils.config:447] Loaded configuration from configs/final_framework_config.yaml
[2025-08-10 15:35:01,973] INFO [__main__:1161] ✅ Loaded configuration from configs/final_framework_config.yaml
[2025-08-10 15:35:01,988] INFO [utils.config:479] Configuration saved to outputs/sanity_2ep/config.yaml
[2025-08-10 15:35:01,989] INFO [__main__:1200] 💾 Saved configuration to outputs/sanity_2ep/config.yaml
[2025-08-10 15:35:01,990] INFO [__main__:1204] 🎯 Starting standard training mode...
[2025-08-10 15:35:01,991] INFO [__main__:1211] 📋 Configuration loaded: cpu device, 128 latent dim
[2025-08-10 15:35:01,991] INFO [__main__:1212] 📋 Spike encoding: phase_preserving
[2025-08-10 15:35:01,992] INFO [__main__:1213] 📋 SNN hidden size: 512
[2025-08-10 15:35:01,992] INFO [__main__:1220] 🔧 Running standard CPC+SNN training...
[2025-08-10 15:35:02,007] INFO [utils.device_auto_detection:201] 🔍 Starting intelligent device detection...
[2025-08-10 15:35:02,009] INFO [utils.device_auto_detection:51] PyTorch not available for GPU detection
[2025-08-10 15:35:02,010] INFO [utils.device_auto_detection:62] JAX devices detected: [CudaDevice(id=0)]
[2025-08-10 15:35:02,011] INFO [utils.device_auto_detection:123] 🔋 STANDARD CPU: 16 cores, 15.6GB RAM
[2025-08-10 15:35:02,011] INFO [utils.device_auto_detection:137] 🔧 Applying optimal device configuration...
[2025-08-10 15:35:02,012] INFO [utils.device_auto_detection:138]    Platform: cpu
[2025-08-10 15:35:02,013] INFO [utils.device_auto_detection:139]    Memory fraction: 0.4
[2025-08-10 15:35:02,013] INFO [utils.device_auto_detection:140]    Recommended batch size: 1
[2025-08-10 15:35:02,014] INFO [utils.device_auto_detection:141]    Expected speedup: 1.0x
[2025-08-10 15:35:02,015] INFO [utils.device_auto_detection:162] ✅ JAX configured successfully:
[2025-08-10 15:35:02,016] INFO [utils.device_auto_detection:163]    Platform: gpu
[2025-08-10 15:35:02,016] INFO [utils.device_auto_detection:164]    Devices: [CudaDevice(id=0)]
[2025-08-10 15:35:02,017] INFO [utils.device_auto_detection:167] 🚀 GPU ACCELERATION ACTIVE - Expected 1.0x speedup!
[2025-08-10 15:35:02,017] INFO [utils.device_auto_detection:215] ✅ Device auto-detection and optimization complete!
[2025-08-10 15:35:02,018] INFO [utils.device_auto_detection:216] 💡 TIP: Your system is optimized for CPU training
[2025-08-10 15:35:02,019] INFO [__main__:57] 🎮 Platform detected: CPU
[2025-08-10 15:35:02,020] INFO [__main__:58] ⚡ Expected speedup: 1.0x
[2025-08-10 15:35:02,024] INFO [__main__:85] 🔧 Real CPC+SNN training pipeline:
[2025-08-10 15:35:02,025] INFO [__main__:93]    - CPC Latent Dim: 128
[2025-08-10 15:35:02,025] INFO [__main__:94]    - Batch Size: 1
[2025-08-10 15:35:02,026] INFO [__main__:95]    - Learning Rate: 0.001
[2025-08-10 15:35:02,027] INFO [__main__:96]    - Epochs: 2
[2025-08-10 15:35:02,027] INFO [__main__:97]    - Spike Encoding: phase_preserving
[2025-08-10 15:35:02,042] INFO [training.training_utils:90] JAX devices: [CudaDevice(id=0)]
[2025-08-10 15:35:02,043] INFO [training.training_utils:91] JAX platform: gpu
[2025-08-10 15:35:02,045] INFO [training.base_trainer:170] Using basic experiment tracker
[2025-08-10 15:35:02,050] INFO [training.training_utils:116] Configuration saved to outputs/sanity_2ep/standard_training_1bs/config.json
[2025-08-10 15:35:02,051] INFO [training.base_trainer:193] Initialized CPCSNNTrainer with config: cpc_snn_gw
[2025-08-10 15:35:02,055] INFO [__main__:102] 🚀 Creating CPC+SNN model with SpikeBridge...
[2025-08-10 15:35:02,059] INFO [__main__:105] 📊 Creating data loaders...
[2025-08-10 15:35:02,086] WARNING [data.gw_dataset_builder:29] TensorFlow not available - TFRecord export disabled
[2025-08-10 15:35:02,088] INFO [__main__:113]    Creating REAL LIGO dataset with GW150914 data...
[2025-08-10 15:35:02,112] INFO [data.real_ligo_integration:251] 🚀 Creating ENHANCED dataset with 2000 target samples
[2025-08-10 15:35:02,113] INFO [data.real_ligo_integration:252]    Enhanced overlap: 90.0%
[2025-08-10 15:35:02,114] INFO [data.real_ligo_integration:253]    Data augmentation: True
[2025-08-10 15:35:02,116] WARNING [data.real_ligo_integration:41] ❌ ReadLIGO loading failed: ModuleNotFoundError: No module named 'readligo'
[2025-08-10 15:35:02,120] INFO [data.real_ligo_integration:50] ✅ Using h5py fallback - loading LOSC HDF5 files directly
[2025-08-10 15:35:02,230] INFO [data.real_ligo_integration:91] ✅ Successfully loaded real GW150914 strain data (source=h5py): 2048 samples
[2025-08-10 15:35:02,231] INFO [data.real_ligo_integration:92] 📊 Strain amplitude range: -7.60e-21 to -2.08e-21
[2025-08-10 15:35:02,232] INFO [data.real_ligo_integration:261] 📡 Processing real LIGO data with enhanced windowing...
[2025-08-10 15:35:02,256] INFO [data.real_ligo_integration:270] ✅ Real LIGO windows: 31 (vs previous ~15)
[2025-08-10 15:35:03,089] INFO [data.real_ligo_integration:276] 🔄 Applying data augmentation to real LIGO data...
[2025-08-10 15:35:04,148] INFO [data.real_ligo_integration:289] ✅ Augmented data: +155 samples
[2025-08-10 15:35:04,618] INFO [data.real_ligo_integration:319] 🔄 Generating 1814 synthetic GW samples...
[2025-08-10 15:35:42,569] INFO [data.real_ligo_integration:364] 🎯 ENHANCED DATASET CREATED:
[2025-08-10 15:35:42,572] INFO [data.real_ligo_integration:365]    Total samples: 2000
[2025-08-10 15:35:42,574] INFO [data.real_ligo_integration:366]    Window size: 512
[2025-08-10 15:35:43,216] INFO [data.real_ligo_integration:367]    GW signals: 729 (36.5%)
[2025-08-10 15:35:43,508] INFO [data.real_ligo_integration:368]    Noise samples: 1271 (63.6%)
[2025-08-10 15:35:49,126] INFO [utils.data_split:49] 📊 Creating stratified split (train: 80.0%):
[2025-08-10 15:35:49,129] INFO [utils.data_split:50]    Class 0 samples: 1271
[2025-08-10 15:35:49,130] INFO [utils.data_split:51]    Class 1 samples: 729
[2025-08-10 15:35:59,055] INFO [utils.data_split:90] 📊 Dataset split completed:
[2025-08-10 15:35:59,057] INFO [utils.data_split:91]    Train: 1599 samples
[2025-08-10 15:35:59,058] INFO [utils.data_split:92]    Test: 401 samples
[2025-08-10 15:35:59,323] INFO [utils.data_split:93]    Train class balance: 36.5% positive
[2025-08-10 15:35:59,556] INFO [utils.data_split:94]    Test class balance: 36.4% positive
[2025-08-10 15:36:00,002] INFO [utils.data_split:105] ✅ Balanced test set: 36.4% positive
[2025-08-10 15:36:00,003] INFO [__main__:165]    Enhanced REAL LIGO samples: train=1599, test=401
[2025-08-10 15:36:00,005] INFO [__main__:200] ⏳ Starting real training loop...
[2025-08-10 15:36:00,007] INFO [__main__:205]    Training data shape: (1599, 512)
[2025-08-10 15:36:00,008] INFO [__main__:206]    Labels shape: (1599,)
[2025-08-10 15:36:00,010] INFO [__main__:207]    Running 2 epochs...
[2025-08-10 15:36:00,011] INFO [__main__:212] 🚀 Starting REAL CPC+SNN training pipeline!
[2025-08-10 15:36:00,043] INFO [training.training_utils:90] JAX devices: [CudaDevice(id=0)]
[2025-08-10 15:36:00,044] INFO [training.training_utils:91] JAX platform: gpu
[2025-08-10 15:36:00,046] INFO [training.base_trainer:170] Using basic experiment tracker
[2025-08-10 15:36:00,051] INFO [training.training_utils:116] Configuration saved to outputs/sanity_2ep/standard_training_1bs/config.json
[2025-08-10 15:36:00,052] INFO [training.base_trainer:193] Initialized CPCSNNTrainer with config: cpc_snn_gw
[2025-08-10 15:36:55,319] ERROR [__main__:554] Training loop failed: Cannot broadcast to shape with fewer dimensions: arr_shape=(1, 1, 128, 64, 8) shape=(1, 24, 128, 8)
[2025-08-10 15:36:55,426] ERROR [__main__:1245] ❌ Training failed!
[2025-08-10 15:42:00,398] INFO [__main__:995] Forcing CPU backend as requested by --device=cpu
[2025-08-10 15:42:00,399] INFO [__main__:1007] 🚀 Starting CPC+SNN training (v0.1.dev2+g95217e9.d20250716)
[2025-08-10 15:42:00,399] INFO [__main__:1008]    Output directory: outputs/sanity_2ep
[2025-08-10 15:42:00,400] INFO [__main__:1009]    Configuration: configs/final_framework_config.yaml
[2025-08-10 15:42:00,400] INFO [__main__:1012] 🔧 Configuring JAX GPU settings...
[2025-08-10 15:42:00,420] INFO [__main__:1018] 🔧 Applying performance optimizations (startup)
[2025-08-10 15:42:00,420] INFO [utils.config:36] ✅ Applying runtime performance optimizations...
[2025-08-10 15:42:03,423] INFO [utils.config:60] JAX platform: gpu
[2025-08-10 15:42:03,424] INFO [utils.config:61] JAX devices: [CudaDevice(id=0)]
[2025-08-10 15:42:03,425] INFO [utils.config:62] Memory fraction: 0.35
[2025-08-10 15:42:03,426] INFO [utils.config:68] System memory: 16.7GB total, 15.7GB available
[2025-08-10 15:42:03,426] INFO [__main__:1023] 🔧 Pre-compiling models (startup)
[2025-08-10 15:42:03,427] INFO [utils.config:114] ⏭️ Skipping JIT pre-compilation on dummy inputs (user preference)
[2025-08-10 15:42:03,427] INFO [__main__:1046] 🔥 Performing COMPREHENSIVE GPU warmup to eliminate timing issues...
[2025-08-10 15:42:04,572] INFO [__main__:1051]    🔸 Stage 1: Basic tensor operations...
[2025-08-10 15:42:10,299] INFO [__main__:1059]    🔸 Stage 2: Dense layer operations...
[2025-08-10 15:42:13,454] INFO [__main__:1069]    🔸 Stage 3: CPC/SNN operations...
[2025-08-10 15:42:16,631] INFO [__main__:1087]    🔸 Stage 4: Advanced CUDA kernels...
[2025-08-10 15:42:18,783] INFO [__main__:1100]    🔸 Stage 5: JAX JIT compilation warmup...
[2025-08-10 15:42:19,129] INFO [__main__:1114]    🔸 Stage 6: SpikeBridge/CPC specific warmup...
[2025-08-10 15:42:27,502] INFO [__main__:1139] ✅ COMPREHENSIVE GPU warmup completed - ALL CUDA kernels initialized!
[2025-08-10 15:42:27,503] INFO [__main__:1146] 🎯 GPU devices available: 1
[2025-08-10 15:42:27,524] INFO [utils.config:444] Adding default enhanced W&B configuration
[2025-08-10 15:42:27,525] INFO [utils.config:447] Loaded configuration from configs/final_framework_config.yaml
[2025-08-10 15:42:27,525] INFO [__main__:1161] ✅ Loaded configuration from configs/final_framework_config.yaml
[2025-08-10 15:42:27,539] INFO [utils.config:479] Configuration saved to outputs/sanity_2ep/config.yaml
[2025-08-10 15:42:27,540] INFO [__main__:1200] 💾 Saved configuration to outputs/sanity_2ep/config.yaml
[2025-08-10 15:42:27,541] INFO [__main__:1204] 🎯 Starting standard training mode...
[2025-08-10 15:42:27,541] INFO [__main__:1211] 📋 Configuration loaded: cpu device, 128 latent dim
[2025-08-10 15:42:27,542] INFO [__main__:1212] 📋 Spike encoding: phase_preserving
[2025-08-10 15:42:27,543] INFO [__main__:1213] 📋 SNN hidden size: 512
[2025-08-10 15:42:27,543] INFO [__main__:1220] 🔧 Running standard CPC+SNN training...
[2025-08-10 15:42:27,555] INFO [utils.device_auto_detection:201] 🔍 Starting intelligent device detection...
[2025-08-10 15:42:27,557] INFO [utils.device_auto_detection:51] PyTorch not available for GPU detection
[2025-08-10 15:42:27,558] INFO [utils.device_auto_detection:62] JAX devices detected: [CudaDevice(id=0)]
[2025-08-10 15:42:27,558] INFO [utils.device_auto_detection:123] 🔋 STANDARD CPU: 16 cores, 15.6GB RAM
[2025-08-10 15:42:27,559] INFO [utils.device_auto_detection:137] 🔧 Applying optimal device configuration...
[2025-08-10 15:42:27,560] INFO [utils.device_auto_detection:138]    Platform: cpu
[2025-08-10 15:42:27,560] INFO [utils.device_auto_detection:139]    Memory fraction: 0.4
[2025-08-10 15:42:27,561] INFO [utils.device_auto_detection:140]    Recommended batch size: 1
[2025-08-10 15:42:27,561] INFO [utils.device_auto_detection:141]    Expected speedup: 1.0x
[2025-08-10 15:42:27,562] INFO [utils.device_auto_detection:162] ✅ JAX configured successfully:
[2025-08-10 15:42:27,563] INFO [utils.device_auto_detection:163]    Platform: gpu
[2025-08-10 15:42:27,564] INFO [utils.device_auto_detection:164]    Devices: [CudaDevice(id=0)]
[2025-08-10 15:42:27,564] INFO [utils.device_auto_detection:167] 🚀 GPU ACCELERATION ACTIVE - Expected 1.0x speedup!
[2025-08-10 15:42:27,565] INFO [utils.device_auto_detection:215] ✅ Device auto-detection and optimization complete!
[2025-08-10 15:42:27,565] INFO [utils.device_auto_detection:216] 💡 TIP: Your system is optimized for CPU training
[2025-08-10 15:42:27,566] INFO [__main__:57] 🎮 Platform detected: CPU
[2025-08-10 15:42:27,566] INFO [__main__:58] ⚡ Expected speedup: 1.0x
[2025-08-10 15:42:27,569] INFO [__main__:85] 🔧 Real CPC+SNN training pipeline:
[2025-08-10 15:42:27,569] INFO [__main__:93]    - CPC Latent Dim: 128
[2025-08-10 15:42:27,570] INFO [__main__:94]    - Batch Size: 1
[2025-08-10 15:42:27,570] INFO [__main__:95]    - Learning Rate: 0.001
[2025-08-10 15:42:27,571] INFO [__main__:96]    - Epochs: 2
[2025-08-10 15:42:27,571] INFO [__main__:97]    - Spike Encoding: phase_preserving
[2025-08-10 15:42:27,587] INFO [training.training_utils:90] JAX devices: [CudaDevice(id=0)]
[2025-08-10 15:42:27,588] INFO [training.training_utils:91] JAX platform: gpu
[2025-08-10 15:42:27,590] INFO [training.base_trainer:170] Using basic experiment tracker
[2025-08-10 15:42:27,596] INFO [training.training_utils:116] Configuration saved to outputs/sanity_2ep/standard_training_1bs/config.json
[2025-08-10 15:42:27,597] INFO [training.base_trainer:193] Initialized CPCSNNTrainer with config: cpc_snn_gw
[2025-08-10 15:42:27,599] INFO [__main__:102] 🚀 Creating CPC+SNN model with SpikeBridge...
[2025-08-10 15:42:27,601] INFO [__main__:105] 📊 Creating data loaders...
[2025-08-10 15:42:27,615] WARNING [data.gw_dataset_builder:29] TensorFlow not available - TFRecord export disabled
[2025-08-10 15:42:27,616] INFO [__main__:113]    Creating REAL LIGO dataset with GW150914 data...
[2025-08-10 15:42:27,628] INFO [data.real_ligo_integration:251] 🚀 Creating ENHANCED dataset with 2000 target samples
[2025-08-10 15:42:27,629] INFO [data.real_ligo_integration:252]    Enhanced overlap: 90.0%
[2025-08-10 15:42:27,630] INFO [data.real_ligo_integration:253]    Data augmentation: True
[2025-08-10 15:42:27,632] WARNING [data.real_ligo_integration:41] ❌ ReadLIGO loading failed: ModuleNotFoundError: No module named 'readligo'
[2025-08-10 15:42:27,635] INFO [data.real_ligo_integration:50] ✅ Using h5py fallback - loading LOSC HDF5 files directly
[2025-08-10 15:42:27,726] INFO [data.real_ligo_integration:91] ✅ Successfully loaded real GW150914 strain data (source=h5py): 2048 samples
[2025-08-10 15:42:27,728] INFO [data.real_ligo_integration:92] 📊 Strain amplitude range: -7.60e-21 to -2.08e-21
[2025-08-10 15:42:27,728] INFO [data.real_ligo_integration:261] 📡 Processing real LIGO data with enhanced windowing...
[2025-08-10 15:42:27,740] INFO [data.real_ligo_integration:270] ✅ Real LIGO windows: 31 (vs previous ~15)
[2025-08-10 15:42:28,489] INFO [data.real_ligo_integration:276] 🔄 Applying data augmentation to real LIGO data...
[2025-08-10 15:42:29,518] INFO [data.real_ligo_integration:289] ✅ Augmented data: +155 samples
[2025-08-10 15:42:29,970] INFO [data.real_ligo_integration:319] 🔄 Generating 1814 synthetic GW samples...
[2025-08-10 15:42:59,897] INFO [data.real_ligo_integration:364] 🎯 ENHANCED DATASET CREATED:
[2025-08-10 15:42:59,898] INFO [data.real_ligo_integration:365]    Total samples: 2000
[2025-08-10 15:42:59,899] INFO [data.real_ligo_integration:366]    Window size: 512
[2025-08-10 15:43:00,301] INFO [data.real_ligo_integration:367]    GW signals: 729 (36.5%)
[2025-08-10 15:43:00,483] INFO [data.real_ligo_integration:368]    Noise samples: 1271 (63.6%)
[2025-08-10 15:43:03,814] INFO [utils.data_split:49] 📊 Creating stratified split (train: 80.0%):
[2025-08-10 15:43:03,816] INFO [utils.data_split:50]    Class 0 samples: 1271
[2025-08-10 15:43:03,817] INFO [utils.data_split:51]    Class 1 samples: 729
[2025-08-10 15:43:10,270] INFO [utils.data_split:90] 📊 Dataset split completed:
[2025-08-10 15:43:10,271] INFO [utils.data_split:91]    Train: 1599 samples
[2025-08-10 15:43:10,272] INFO [utils.data_split:92]    Test: 401 samples
[2025-08-10 15:43:10,491] INFO [utils.data_split:93]    Train class balance: 36.5% positive
[2025-08-10 15:43:10,700] INFO [utils.data_split:94]    Test class balance: 36.4% positive
[2025-08-10 15:43:11,105] INFO [utils.data_split:105] ✅ Balanced test set: 36.4% positive
[2025-08-10 15:43:11,106] INFO [__main__:165]    Enhanced REAL LIGO samples: train=1599, test=401
[2025-08-10 15:43:11,107] INFO [__main__:200] ⏳ Starting real training loop...
[2025-08-10 15:43:11,108] INFO [__main__:205]    Training data shape: (1599, 512)
[2025-08-10 15:43:11,109] INFO [__main__:206]    Labels shape: (1599,)
[2025-08-10 15:43:11,110] INFO [__main__:207]    Running 2 epochs...
[2025-08-10 15:43:11,111] INFO [__main__:212] 🚀 Starting REAL CPC+SNN training pipeline!
[2025-08-10 15:43:11,130] INFO [training.training_utils:90] JAX devices: [CudaDevice(id=0)]
[2025-08-10 15:43:11,131] INFO [training.training_utils:91] JAX platform: gpu
[2025-08-10 15:43:11,133] INFO [training.base_trainer:170] Using basic experiment tracker
[2025-08-10 15:43:11,138] INFO [training.training_utils:116] Configuration saved to outputs/sanity_2ep/standard_training_1bs/config.json
[2025-08-10 15:43:11,140] INFO [training.base_trainer:193] Initialized CPCSNNTrainer with config: cpc_snn_gw
[2025-08-10 15:44:05,659] INFO [absl:375] Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x7d3fff960f50>, enable_pinned_host_transfer=True, save_concurrent_bytes: 96000000000 (89.4 GiB), restore_concurrent_bytes: 96000000000 (89.4 GiB)
[2025-08-10 15:44:05,661] INFO [absl:35] orbax-checkpoint version: 0.11.21
[2025-08-10 15:44:05,663] WARNING [__main__:271] Orbax managers unavailable: CheckpointManager.__init__() got an unexpected keyword argument 'checkpointer'
[2025-08-10 15:44:05,664] INFO [__main__:276]    🔥 Epoch 1/2
[2025-08-10 15:44:24,747] ERROR [__main__:554] Training loop failed: spike_bridge needs PRNG for "spike_noise" (https://flax.readthedocs.io/en/latest/api_reference/flax.errors.html#flax.errors.InvalidRngError)
[2025-08-10 15:44:24,761] ERROR [__main__:1245] ❌ Training failed!
[2025-08-10 15:47:56,581] INFO [__main__:995] Forcing CPU backend as requested by --device=cpu
[2025-08-10 15:47:56,582] INFO [__main__:1007] 🚀 Starting CPC+SNN training (v0.1.dev2+g95217e9.d20250716)
[2025-08-10 15:47:56,582] INFO [__main__:1008]    Output directory: outputs/sanity_2ep
[2025-08-10 15:47:56,583] INFO [__main__:1009]    Configuration: configs/final_framework_config.yaml
[2025-08-10 15:47:56,583] INFO [__main__:1012] 🔧 Configuring JAX GPU settings...
[2025-08-10 15:47:56,602] INFO [__main__:1018] 🔧 Applying performance optimizations (startup)
[2025-08-10 15:47:56,603] INFO [utils.config:36] ✅ Applying runtime performance optimizations...
[2025-08-10 15:47:59,690] INFO [utils.config:60] JAX platform: gpu
[2025-08-10 15:47:59,691] INFO [utils.config:61] JAX devices: [CudaDevice(id=0)]
[2025-08-10 15:47:59,692] INFO [utils.config:62] Memory fraction: 0.35
[2025-08-10 15:47:59,693] INFO [utils.config:68] System memory: 16.7GB total, 15.7GB available
[2025-08-10 15:47:59,693] INFO [__main__:1023] 🔧 Pre-compiling models (startup)
[2025-08-10 15:47:59,694] INFO [utils.config:114] ⏭️ Skipping JIT pre-compilation on dummy inputs (user preference)
[2025-08-10 15:47:59,695] INFO [__main__:1046] 🔥 Performing COMPREHENSIVE GPU warmup to eliminate timing issues...
[2025-08-10 15:48:01,150] INFO [__main__:1051]    🔸 Stage 1: Basic tensor operations...
[2025-08-10 15:48:07,112] INFO [__main__:1059]    🔸 Stage 2: Dense layer operations...
[2025-08-10 15:48:10,352] INFO [__main__:1069]    🔸 Stage 3: CPC/SNN operations...
[2025-08-10 15:48:13,578] INFO [__main__:1087]    🔸 Stage 4: Advanced CUDA kernels...
[2025-08-10 15:48:15,734] INFO [__main__:1100]    🔸 Stage 5: JAX JIT compilation warmup...
[2025-08-10 15:48:16,084] INFO [__main__:1114]    🔸 Stage 6: SpikeBridge/CPC specific warmup...
[2025-08-10 15:48:24,794] INFO [__main__:1139] ✅ COMPREHENSIVE GPU warmup completed - ALL CUDA kernels initialized!
[2025-08-10 15:48:24,795] INFO [__main__:1146] 🎯 GPU devices available: 1
[2025-08-10 15:48:24,816] INFO [utils.config:444] Adding default enhanced W&B configuration
[2025-08-10 15:48:24,816] INFO [utils.config:447] Loaded configuration from configs/final_framework_config.yaml
[2025-08-10 15:48:24,817] INFO [__main__:1161] ✅ Loaded configuration from configs/final_framework_config.yaml
[2025-08-10 15:48:24,831] INFO [utils.config:479] Configuration saved to outputs/sanity_2ep/config.yaml
[2025-08-10 15:48:24,832] INFO [__main__:1200] 💾 Saved configuration to outputs/sanity_2ep/config.yaml
[2025-08-10 15:48:24,832] INFO [__main__:1204] 🎯 Starting standard training mode...
[2025-08-10 15:48:24,833] INFO [__main__:1211] 📋 Configuration loaded: cpu device, 128 latent dim
[2025-08-10 15:48:24,833] INFO [__main__:1212] 📋 Spike encoding: phase_preserving
[2025-08-10 15:48:24,834] INFO [__main__:1213] 📋 SNN hidden size: 512
[2025-08-10 15:48:24,834] INFO [__main__:1220] 🔧 Running standard CPC+SNN training...
[2025-08-10 15:48:24,847] INFO [utils.device_auto_detection:201] 🔍 Starting intelligent device detection...
[2025-08-10 15:48:24,848] INFO [utils.device_auto_detection:51] PyTorch not available for GPU detection
[2025-08-10 15:48:24,849] INFO [utils.device_auto_detection:62] JAX devices detected: [CudaDevice(id=0)]
[2025-08-10 15:48:24,850] INFO [utils.device_auto_detection:123] 🔋 STANDARD CPU: 16 cores, 15.6GB RAM
[2025-08-10 15:48:24,850] INFO [utils.device_auto_detection:137] 🔧 Applying optimal device configuration...
[2025-08-10 15:48:24,851] INFO [utils.device_auto_detection:138]    Platform: cpu
[2025-08-10 15:48:24,851] INFO [utils.device_auto_detection:139]    Memory fraction: 0.4
[2025-08-10 15:48:24,852] INFO [utils.device_auto_detection:140]    Recommended batch size: 1
[2025-08-10 15:48:24,852] INFO [utils.device_auto_detection:141]    Expected speedup: 1.0x
[2025-08-10 15:48:24,853] INFO [utils.device_auto_detection:162] ✅ JAX configured successfully:
[2025-08-10 15:48:24,854] INFO [utils.device_auto_detection:163]    Platform: gpu
[2025-08-10 15:48:24,854] INFO [utils.device_auto_detection:164]    Devices: [CudaDevice(id=0)]
[2025-08-10 15:48:24,855] INFO [utils.device_auto_detection:167] 🚀 GPU ACCELERATION ACTIVE - Expected 1.0x speedup!
[2025-08-10 15:48:24,855] INFO [utils.device_auto_detection:215] ✅ Device auto-detection and optimization complete!
[2025-08-10 15:48:24,856] INFO [utils.device_auto_detection:216] 💡 TIP: Your system is optimized for CPU training
[2025-08-10 15:48:24,856] INFO [__main__:57] 🎮 Platform detected: CPU
[2025-08-10 15:48:24,857] INFO [__main__:58] ⚡ Expected speedup: 1.0x
[2025-08-10 15:48:24,860] INFO [__main__:85] 🔧 Real CPC+SNN training pipeline:
[2025-08-10 15:48:24,861] INFO [__main__:93]    - CPC Latent Dim: 128
[2025-08-10 15:48:24,862] INFO [__main__:94]    - Batch Size: 1
[2025-08-10 15:48:24,862] INFO [__main__:95]    - Learning Rate: 0.001
[2025-08-10 15:48:24,863] INFO [__main__:96]    - Epochs: 2
[2025-08-10 15:48:24,863] INFO [__main__:97]    - Spike Encoding: phase_preserving
[2025-08-10 15:48:24,880] INFO [training.training_utils:90] JAX devices: [CudaDevice(id=0)]
[2025-08-10 15:48:24,881] INFO [training.training_utils:91] JAX platform: gpu
[2025-08-10 15:48:24,882] INFO [training.base_trainer:170] Using basic experiment tracker
[2025-08-10 15:48:24,886] INFO [training.training_utils:116] Configuration saved to outputs/sanity_2ep/standard_training_1bs/config.json
[2025-08-10 15:48:24,888] INFO [training.base_trainer:193] Initialized CPCSNNTrainer with config: cpc_snn_gw
[2025-08-10 15:48:24,890] INFO [__main__:102] 🚀 Creating CPC+SNN model with SpikeBridge...
[2025-08-10 15:48:24,892] INFO [__main__:105] 📊 Creating data loaders...
[2025-08-10 15:48:24,904] WARNING [data.gw_dataset_builder:29] TensorFlow not available - TFRecord export disabled
[2025-08-10 15:48:24,906] INFO [__main__:113]    Creating REAL LIGO dataset with GW150914 data...
[2025-08-10 15:48:24,918] INFO [data.real_ligo_integration:251] 🚀 Creating ENHANCED dataset with 2000 target samples
[2025-08-10 15:48:24,919] INFO [data.real_ligo_integration:252]    Enhanced overlap: 90.0%
[2025-08-10 15:48:24,920] INFO [data.real_ligo_integration:253]    Data augmentation: True
[2025-08-10 15:48:24,922] WARNING [data.real_ligo_integration:41] ❌ ReadLIGO loading failed: ModuleNotFoundError: No module named 'readligo'
[2025-08-10 15:48:24,925] INFO [data.real_ligo_integration:50] ✅ Using h5py fallback - loading LOSC HDF5 files directly
[2025-08-10 15:48:25,013] INFO [data.real_ligo_integration:91] ✅ Successfully loaded real GW150914 strain data (source=h5py): 2048 samples
[2025-08-10 15:48:25,014] INFO [data.real_ligo_integration:92] 📊 Strain amplitude range: -7.60e-21 to -2.08e-21
[2025-08-10 15:48:25,015] INFO [data.real_ligo_integration:261] 📡 Processing real LIGO data with enhanced windowing...
[2025-08-10 15:48:25,027] INFO [data.real_ligo_integration:270] ✅ Real LIGO windows: 31 (vs previous ~15)
[2025-08-10 15:48:25,801] INFO [data.real_ligo_integration:276] 🔄 Applying data augmentation to real LIGO data...
[2025-08-10 15:48:26,884] INFO [data.real_ligo_integration:289] ✅ Augmented data: +155 samples
[2025-08-10 15:48:27,331] INFO [data.real_ligo_integration:319] 🔄 Generating 1814 synthetic GW samples...
[2025-08-10 15:48:57,210] INFO [data.real_ligo_integration:364] 🎯 ENHANCED DATASET CREATED:
[2025-08-10 15:48:57,211] INFO [data.real_ligo_integration:365]    Total samples: 2000
[2025-08-10 15:48:57,212] INFO [data.real_ligo_integration:366]    Window size: 512
[2025-08-10 15:48:57,644] INFO [data.real_ligo_integration:367]    GW signals: 729 (36.5%)
[2025-08-10 15:48:57,838] INFO [data.real_ligo_integration:368]    Noise samples: 1271 (63.6%)
[2025-08-10 15:49:01,193] INFO [utils.data_split:49] 📊 Creating stratified split (train: 80.0%):
[2025-08-10 15:49:01,194] INFO [utils.data_split:50]    Class 0 samples: 1271
[2025-08-10 15:49:01,195] INFO [utils.data_split:51]    Class 1 samples: 729
[2025-08-10 15:49:07,865] INFO [utils.data_split:90] 📊 Dataset split completed:
[2025-08-10 15:49:07,867] INFO [utils.data_split:91]    Train: 1599 samples
[2025-08-10 15:49:07,867] INFO [utils.data_split:92]    Test: 401 samples
[2025-08-10 15:49:08,094] INFO [utils.data_split:93]    Train class balance: 36.5% positive
[2025-08-10 15:49:08,308] INFO [utils.data_split:94]    Test class balance: 36.4% positive
[2025-08-10 15:49:08,712] INFO [utils.data_split:105] ✅ Balanced test set: 36.4% positive
[2025-08-10 15:49:08,714] INFO [__main__:165]    Enhanced REAL LIGO samples: train=1599, test=401
[2025-08-10 15:49:08,715] INFO [__main__:200] ⏳ Starting real training loop...
[2025-08-10 15:49:08,716] INFO [__main__:205]    Training data shape: (1599, 512)
[2025-08-10 15:49:08,716] INFO [__main__:206]    Labels shape: (1599,)
[2025-08-10 15:49:08,717] INFO [__main__:207]    Running 2 epochs...
[2025-08-10 15:49:08,718] INFO [__main__:212] 🚀 Starting REAL CPC+SNN training pipeline!
[2025-08-10 15:49:08,739] INFO [training.training_utils:90] JAX devices: [CudaDevice(id=0)]
[2025-08-10 15:49:08,740] INFO [training.training_utils:91] JAX platform: gpu
[2025-08-10 15:49:08,743] INFO [training.base_trainer:170] Using basic experiment tracker
[2025-08-10 15:49:08,748] INFO [training.training_utils:116] Configuration saved to outputs/sanity_2ep/standard_training_1bs/config.json
[2025-08-10 15:49:08,750] INFO [training.base_trainer:193] Initialized CPCSNNTrainer with config: cpc_snn_gw
[2025-08-10 15:50:03,548] INFO [absl:375] Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x735caeba0f80>, enable_pinned_host_transfer=True, save_concurrent_bytes: 96000000000 (89.4 GiB), restore_concurrent_bytes: 96000000000 (89.4 GiB)
[2025-08-10 15:50:03,550] INFO [absl:35] orbax-checkpoint version: 0.11.21
[2025-08-10 15:50:03,551] WARNING [__main__:271] Orbax managers unavailable: CheckpointManager.__init__() got an unexpected keyword argument 'checkpointer'
[2025-08-10 15:50:03,553] INFO [__main__:276]    🔥 Epoch 1/2

[2025-08-10 17:08:02,156] INFO [__main__:1016] Forcing CPU backend as requested by --device=cpu
[2025-08-10 17:08:02,157] INFO [__main__:1034] üöÄ Starting CPC+SNN training (v0.1.dev2+g95217e9.d20250716)
[2025-08-10 17:08:02,157] INFO [__main__:1035]    Output directory: outputs/sanity_2ep_cpu_fast
[2025-08-10 17:08:02,158] INFO [__main__:1036]    Configuration: configs/final_framework_config.yaml
[2025-08-10 17:08:02,158] INFO [__main__:1039] üîß Configuring JAX GPU settings...
[2025-08-10 17:08:02,177] INFO [__main__:1045] üîß Applying performance optimizations (startup)
[2025-08-10 17:08:02,177] INFO [utils.config:36] ‚úÖ Applying runtime performance optimizations...
[2025-08-10 17:08:04,445] ERROR [jax._src.xla_bridge:502] Jax plugin configuration error: Exception when calling jax_plugins.xla_cuda12.initialize()
Traceback (most recent call last):
  File "/mnt/c/Users/alpph/Documents/CPC-SNN-GW/.venv/lib/python3.12/site-packages/jax/_src/xla_bridge.py", line 500, in discover_pjrt_plugins
    plugin_module.initialize()
  File "/mnt/c/Users/alpph/Documents/CPC-SNN-GW/.venv/lib/python3.12/site-packages/jax_plugins/xla_cuda12/__init__.py", line 328, in initialize
    _check_cuda_versions(raise_on_first_error=True)
  File "/mnt/c/Users/alpph/Documents/CPC-SNN-GW/.venv/lib/python3.12/site-packages/jax_plugins/xla_cuda12/__init__.py", line 285, in _check_cuda_versions
    local_device_count = cuda_versions.cuda_device_count()
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: jaxlib/cuda/versions_helpers.cc:113: operation cuInit(0) failed: CUDA_ERROR_NO_DEVICE
[2025-08-10 17:08:04,506] WARNING [jax._src.xla_bridge:872] An NVIDIA GPU may be present on this machine, but a CUDA-enabled jaxlib is not installed. Falling back to cpu.
[2025-08-10 17:08:04,506] INFO [utils.config:60] JAX platform: cpu
[2025-08-10 17:08:04,507] INFO [utils.config:61] JAX devices: [CpuDevice(id=0)]
[2025-08-10 17:08:04,508] INFO [utils.config:62] Memory fraction: 0.35
[2025-08-10 17:08:04,509] INFO [utils.config:68] System memory: 16.7GB total, 15.8GB available
[2025-08-10 17:08:04,509] INFO [__main__:1050] üîß Pre-compiling models (startup)
[2025-08-10 17:08:04,510] INFO [utils.config:114] ‚è≠Ô∏è Skipping JIT pre-compilation on dummy inputs (user preference)
[2025-08-10 17:08:04,510] INFO [__main__:1074] ‚è≠Ô∏è Skipping GPU warmup (device is not GPU)
[2025-08-10 17:08:04,511] INFO [__main__:1189]    Continuing with default JAX settings
[2025-08-10 17:08:04,532] INFO [utils.config:444] Adding default enhanced W&B configuration
[2025-08-10 17:08:04,533] INFO [utils.config:447] Loaded configuration from configs/final_framework_config.yaml
[2025-08-10 17:08:04,534] INFO [__main__:1198] ‚úÖ Loaded configuration from configs/final_framework_config.yaml
[2025-08-10 17:08:04,547] INFO [utils.config:479] Configuration saved to outputs/sanity_2ep_cpu_fast/config.yaml
[2025-08-10 17:08:04,548] INFO [__main__:1237] üíæ Saved configuration to outputs/sanity_2ep_cpu_fast/config.yaml
[2025-08-10 17:08:04,549] INFO [__main__:1241] üéØ Starting standard training mode...
[2025-08-10 17:08:04,550] INFO [__main__:1248] üìã Configuration loaded: cpu device, 128 latent dim
[2025-08-10 17:08:04,550] INFO [__main__:1249] üìã Spike encoding: phase_preserving
[2025-08-10 17:08:04,551] INFO [__main__:1250] üìã SNN hidden size: 512
[2025-08-10 17:08:04,552] INFO [__main__:1257] üîß Running standard CPC+SNN training...
[2025-08-10 17:08:04,563] INFO [utils.device_auto_detection:201] üîç Starting intelligent device detection...
[2025-08-10 17:08:04,565] INFO [utils.device_auto_detection:51] PyTorch not available for GPU detection
[2025-08-10 17:08:04,566] INFO [utils.device_auto_detection:62] JAX devices detected: [CpuDevice(id=0)]
[2025-08-10 17:08:04,567] INFO [utils.device_auto_detection:123] üîã STANDARD CPU: 16 cores, 15.6GB RAM
[2025-08-10 17:08:04,568] INFO [utils.device_auto_detection:137] üîß Applying optimal device configuration...
[2025-08-10 17:08:04,569] INFO [utils.device_auto_detection:138]    Platform: cpu
[2025-08-10 17:08:04,569] INFO [utils.device_auto_detection:139]    Memory fraction: 0.4
[2025-08-10 17:08:04,570] INFO [utils.device_auto_detection:140]    Recommended batch size: 1
[2025-08-10 17:08:04,571] INFO [utils.device_auto_detection:141]    Expected speedup: 1.0x
[2025-08-10 17:08:04,571] INFO [utils.device_auto_detection:162] ‚úÖ JAX configured successfully:
[2025-08-10 17:08:04,572] INFO [utils.device_auto_detection:163]    Platform: cpu
[2025-08-10 17:08:04,573] INFO [utils.device_auto_detection:164]    Devices: [CpuDevice(id=0)]
[2025-08-10 17:08:04,573] INFO [utils.device_auto_detection:169] üíª CPU mode active - Consider GPU for 1.0x speedup
[2025-08-10 17:08:04,574] INFO [utils.device_auto_detection:215] ‚úÖ Device auto-detection and optimization complete!
[2025-08-10 17:08:04,574] INFO [utils.device_auto_detection:216] üí° TIP: Your system is optimized for CPU training
[2025-08-10 17:08:04,575] INFO [__main__:63] üéÆ Platform detected: CPU
[2025-08-10 17:08:04,576] INFO [__main__:64] ‚ö° Expected speedup: 1.0x
[2025-08-10 17:08:04,578] INFO [__main__:91] üîß Real CPC+SNN training pipeline:
[2025-08-10 17:08:04,579] INFO [__main__:99]    - CPC Latent Dim: 128
[2025-08-10 17:08:04,579] INFO [__main__:100]    - Batch Size: 1
[2025-08-10 17:08:04,580] INFO [__main__:101]    - Learning Rate: 0.001
[2025-08-10 17:08:04,581] INFO [__main__:102]    - Epochs: 2
[2025-08-10 17:08:04,582] INFO [__main__:103]    - Spike Encoding: phase_preserving
[2025-08-10 17:08:04,595] INFO [training.training_utils:90] JAX devices: [CpuDevice(id=0)]
[2025-08-10 17:08:04,596] INFO [training.training_utils:91] JAX platform: cpu
[2025-08-10 17:08:04,598] INFO [training.base_trainer:170] Using basic experiment tracker
[2025-08-10 17:08:04,604] INFO [training.training_utils:116] Configuration saved to outputs/sanity_2ep_cpu_fast/standard_training_1bs/config.json
[2025-08-10 17:08:04,605] INFO [training.base_trainer:193] Initialized CPCSNNTrainer with config: cpc_snn_gw
[2025-08-10 17:08:05,136] INFO [__main__:108] üöÄ Creating CPC+SNN model with SpikeBridge...
[2025-08-10 17:08:05,139] INFO [__main__:111] üìä Creating data loaders...
[2025-08-10 17:08:05,152] WARNING [data.gw_dataset_builder:29] TensorFlow not available - TFRecord export disabled
[2025-08-10 17:08:05,153] INFO [__main__:119]    Creating REAL LIGO dataset with GW150914 data...
[2025-08-10 17:08:05,174] INFO [__main__:126]    ‚ö° Quick mode: using lightweight real LIGO windows (no augmentation)
[2025-08-10 17:08:05,175] INFO [data.real_ligo_integration:393] üåä Attempting to download real GW150914 data...
[2025-08-10 17:08:05,176] WARNING [data.real_ligo_integration:41] ‚ùå ReadLIGO loading failed: ModuleNotFoundError: No module named 'readligo'
[2025-08-10 17:08:05,180] INFO [data.real_ligo_integration:50] ‚úÖ Using h5py fallback - loading LOSC HDF5 files directly
[2025-08-10 17:08:05,280] INFO [data.real_ligo_integration:91] ‚úÖ Successfully loaded real GW150914 strain data (source=h5py): 2048 samples
[2025-08-10 17:08:05,282] INFO [data.real_ligo_integration:92] üìä Strain amplitude range: -7.60e-21 to -2.08e-21
[2025-08-10 17:08:05,284] INFO [data.real_ligo_integration:399] ‚úÖ GW150914 strain data obtained: 2048 samples
[2025-08-10 17:08:05,295] INFO [data.real_ligo_integration:405] üåä Created proper windowed dataset:
[2025-08-10 17:08:05,296] INFO [data.real_ligo_integration:406]    Total windows: 24
[2025-08-10 17:08:05,297] INFO [data.real_ligo_integration:407]    Window size: 256
[2025-08-10 17:08:05,360] INFO [data.real_ligo_integration:408]    Signal windows (label=1): 5
[2025-08-10 17:08:05,393] INFO [data.real_ligo_integration:409]    Noise windows (label=0): 19
[2025-08-10 17:08:05,427] INFO [data.real_ligo_integration:410]    Class balance: 20.8% positive
[2025-08-10 17:08:06,214] INFO [utils.data_split:49] üìä Creating stratified split (train: 80.0%):
[2025-08-10 17:08:06,215] INFO [utils.data_split:50]    Class 0 samples: 19
[2025-08-10 17:08:06,216] INFO [utils.data_split:51]    Class 1 samples: 5
[2025-08-10 17:08:07,141] INFO [utils.data_split:90] üìä Dataset split completed:
[2025-08-10 17:08:07,142] INFO [utils.data_split:91]    Train: 19 samples
[2025-08-10 17:08:07,143] INFO [utils.data_split:92]    Test: 5 samples
[2025-08-10 17:08:07,172] INFO [utils.data_split:93]    Train class balance: 21.1% positive
[2025-08-10 17:08:07,199] INFO [utils.data_split:94]    Test class balance: 20.0% positive
[2025-08-10 17:08:07,250] INFO [utils.data_split:105] ‚úÖ Balanced test set: 20.0% positive
[2025-08-10 17:08:07,252] INFO [__main__:136]    Quick REAL LIGO samples: train=19, test=5
[2025-08-10 17:08:07,253] INFO [__main__:203] ‚è≥ Starting real training loop...
[2025-08-10 17:08:07,254] INFO [__main__:208]    Training data shape: (19, 256)
[2025-08-10 17:08:07,255] INFO [__main__:209]    Labels shape: (19,)
[2025-08-10 17:08:07,256] INFO [__main__:210]    Running 2 epochs...
[2025-08-10 17:08:07,257] INFO [__main__:215] üöÄ Starting REAL CPC+SNN training pipeline!
[2025-08-10 17:08:07,275] INFO [training.training_utils:90] JAX devices: [CpuDevice(id=0)]
[2025-08-10 17:08:07,276] INFO [training.training_utils:91] JAX platform: cpu
[2025-08-10 17:08:07,277] INFO [training.base_trainer:170] Using basic experiment tracker
[2025-08-10 17:08:07,282] INFO [training.training_utils:116] Configuration saved to outputs/sanity_2ep_cpu_fast/standard_training_1bs/config.json
[2025-08-10 17:08:07,284] INFO [training.base_trainer:193] Initialized CPCSNNTrainer with config: cpc_snn_gw
[2025-08-10 17:08:19,459] INFO [__main__:289] ‚ö° Quick-mode: disabling Orbax checkpoint managers
[2025-08-10 17:08:19,461] INFO [__main__:294]    üî• Epoch 1/2
[2025-08-10 17:11:33,244] INFO [__main__:331]       Step 10/19 loss=0.4013 acc=1.000 | MA20: loss=0.5806 acc=0.700
[2025-08-10 17:13:55,318] INFO [__main__:338]       Loss: 0.6178, Accuracy: 0.6842
[2025-08-10 17:14:07,079] INFO [__main__:380]       Test acc=0.800 | sens=0.000 spec=1.000 prec=0.000 f1=0.000 bal_acc=0.500
[2025-08-10 17:14:07,088] INFO [training.training_metrics:328] New best balanced_accuracy: 0.500000 at epoch 0
[2025-08-10 17:14:07,095] INFO [__main__:479]       üèÜ New best balanced accuracy; saving best checkpoint
[2025-08-10 17:14:07,097] INFO [__main__:294]    üî• Epoch 2/2
[2025-08-10 17:16:45,292] INFO [__main__:331]       Step 10/19 loss=0.9911 acc=0.000 | MA20: loss=0.7870 acc=0.500
[2025-08-10 17:19:09,797] INFO [__main__:338]       Loss: 0.8490, Accuracy: 0.4737
[2025-08-10 17:19:10,617] INFO [__main__:380]       Test acc=0.800 | sens=0.000 spec=1.000 prec=0.000 f1=0.000 bal_acc=0.500
[2025-08-10 17:19:10,630] INFO [__main__:506] üéâ REAL Training completed in 663.4s!
[2025-08-10 17:19:10,631] INFO [training.test_evaluation:51] 
üß™ Evaluating on test set...
[2025-08-10 17:19:11,981] INFO [training.test_evaluation:102] üìä TEST SET ANALYSIS:
[2025-08-10 17:19:11,982] INFO [training.test_evaluation:103]    Test samples: 5
[2025-08-10 17:19:11,984] INFO [training.test_evaluation:104]    True labels - Class 0: 4, Class 1: 1
[2025-08-10 17:19:11,985] INFO [training.test_evaluation:105]    Predictions - Class 0: 5, Class 1: 0
[2025-08-10 17:19:11,987] INFO [training.test_evaluation:106]    Test accuracy: 80.0%
[2025-08-10 17:19:11,991] WARNING [training.test_evaluation:115] üö® MODEL ALWAYS PREDICTS CLASS 0 ON TEST SET!
[2025-08-10 17:19:11,992] WARNING [training.test_evaluation:116]    This suggests the model didn't learn properly
[2025-08-10 17:19:11,994] INFO [training.test_evaluation:120] üîç TEST PREDICTIONS vs LABELS:
[2025-08-10 17:19:12,070] INFO [training.test_evaluation:123]    Test 0: Pred=0, True=0 ‚úÖ
[2025-08-10 17:19:12,074] INFO [training.test_evaluation:123]    Test 1: Pred=0, True=0 ‚úÖ
[2025-08-10 17:19:12,077] INFO [training.test_evaluation:123]    Test 2: Pred=0, True=0 ‚úÖ
[2025-08-10 17:19:12,079] INFO [training.test_evaluation:123]    Test 3: Pred=0, True=1 ‚ùå
[2025-08-10 17:19:12,082] INFO [training.test_evaluation:123]    Test 4: Pred=0, True=0 ‚úÖ
[2025-08-10 17:19:12,085] INFO [__main__:527] ======================================================================
üß™ TEST EVALUATION SUMMARY üß™
======================================================================
Training Accuracy: 47.4%
Test Accuracy: 80.0% (This is the REAL accuracy!)
üî¨ Good performance - verify results!
üö® MODEL COLLAPSE: Always predicts class 0
Data Source: Real LIGO GW150914
Epochs: 2
======================================================================
[2025-08-10 17:19:12,088] INFO [__main__:529] üéâ Training completed successfully!
[2025-08-10 17:19:12,090] INFO [__main__:530]    - Total epochs: 2
[2025-08-10 17:19:12,091] INFO [__main__:531]    - Final loss: 0.8490
[2025-08-10 17:19:12,092] INFO [__main__:532]    - Training accuracy: 0.4737
[2025-08-10 17:19:12,094] INFO [__main__:533]    - Test accuracy: 0.8000 (REAL accuracy)
[2025-08-10 17:19:12,095] INFO [__main__:534]    - Training time: 663.4s
[2025-08-10 17:19:12,098] INFO [__main__:538]    Model saved to: /mnt/c/Users/alpph/Documents/CPC-SNN-GW/outputs/sanity_2ep_cpu_fast/standard_training_1bs/final_model.orbax
[2025-08-10 17:19:12,131] INFO [__main__:1277] ‚úÖ Training completed successfully!
[2025-08-10 17:19:12,135] INFO [__main__:1278] üìä Final metrics: {'final_train_loss': 0.8489533474570826, 'final_train_accuracy': 0.47368421052631576, 'final_test_accuracy': 0.800000011920929, 'final_val_loss': None, 'final_val_accuracy': None, 'total_epochs': 2, 'total_steps': 38, 'best_metric': 0.800000011920929, 'training_time_seconds': 663.3725111484528, 'model_params': 250000, 'has_proper_test_set': True, 'model_collapse': True, 'test_analysis': {'test_accuracy': 0.800000011920929, 'has_proper_test_set': True, 'data_leakage': False, 'model_collapse': True, 'collapsed_class': 0, 'class_counts_true': {0: 4, 1: 1}, 'class_counts_pred': {0: 5, 1: 0}, 'suspicious_patterns': ['model_collapse'], 'sensitivity': 0.0, 'specificity': 1.0, 'precision': 0.0, 'recall': 0.0, 'f1_score': 0.0, 'predictions': [0, 0, 0, 0, 0], 'true_labels': [0, 0, 0, 1, 0], 'probabilities': [0.07726236432790756, 0.05582796782255173, 0.07798897475004196, 0.058377455919981, 0.04372261092066765], 'auc_roc': 0.0, 'auc_pr': 0.0, 'roc_curve': {}, 'pr_curve': {}, 'opt_threshold': 0.5, 'ece': 0.19946466758847237, 'event_level': {}}}
[2025-08-10 17:19:12,138] INFO [__main__:1279] üíæ Model saved to: /mnt/c/Users/alpph/Documents/CPC-SNN-GW/outputs/sanity_2ep_cpu_fast/standard_training_1bs/final_model.orbax

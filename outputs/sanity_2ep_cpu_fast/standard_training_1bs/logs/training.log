2025-08-10 17:08:04,595 - training.training_utils - INFO - JAX devices: [CpuDevice(id=0)]
2025-08-10 17:08:04,596 - training.training_utils - INFO - JAX platform: cpu
2025-08-10 17:08:04,598 - training.base_trainer - INFO - Using basic experiment tracker
2025-08-10 17:08:04,604 - training.training_utils - INFO - Configuration saved to outputs/sanity_2ep_cpu_fast/standard_training_1bs/config.json
2025-08-10 17:08:04,605 - training.base_trainer - INFO - Initialized CPCSNNTrainer with config: cpc_snn_gw
2025-08-10 17:08:05,136 - __main__ - INFO - 🚀 Creating CPC+SNN model with SpikeBridge...
2025-08-10 17:08:05,139 - __main__ - INFO - 📊 Creating data loaders...
2025-08-10 17:08:05,152 - data.gw_dataset_builder - WARNING - TensorFlow not available - TFRecord export disabled
2025-08-10 17:08:05,153 - __main__ - INFO -    Creating REAL LIGO dataset with GW150914 data...
2025-08-10 17:08:05,174 - __main__ - INFO -    ⚡ Quick mode: using lightweight real LIGO windows (no augmentation)
2025-08-10 17:08:05,175 - data.real_ligo_integration - INFO - 🌊 Attempting to download real GW150914 data...
2025-08-10 17:08:05,176 - data.real_ligo_integration - WARNING - ❌ ReadLIGO loading failed: ModuleNotFoundError: No module named 'readligo'
2025-08-10 17:08:05,180 - data.real_ligo_integration - INFO - ✅ Using h5py fallback - loading LOSC HDF5 files directly
2025-08-10 17:08:05,280 - data.real_ligo_integration - INFO - ✅ Successfully loaded real GW150914 strain data (source=h5py): 2048 samples
2025-08-10 17:08:05,282 - data.real_ligo_integration - INFO - 📊 Strain amplitude range: -7.60e-21 to -2.08e-21
2025-08-10 17:08:05,284 - data.real_ligo_integration - INFO - ✅ GW150914 strain data obtained: 2048 samples
2025-08-10 17:08:05,295 - data.real_ligo_integration - INFO - 🌊 Created proper windowed dataset:
2025-08-10 17:08:05,296 - data.real_ligo_integration - INFO -    Total windows: 24
2025-08-10 17:08:05,297 - data.real_ligo_integration - INFO -    Window size: 256
2025-08-10 17:08:05,360 - data.real_ligo_integration - INFO -    Signal windows (label=1): 5
2025-08-10 17:08:05,393 - data.real_ligo_integration - INFO -    Noise windows (label=0): 19
2025-08-10 17:08:05,427 - data.real_ligo_integration - INFO -    Class balance: 20.8% positive
2025-08-10 17:08:06,214 - utils.data_split - INFO - 📊 Creating stratified split (train: 80.0%):
2025-08-10 17:08:06,215 - utils.data_split - INFO -    Class 0 samples: 19
2025-08-10 17:08:06,216 - utils.data_split - INFO -    Class 1 samples: 5
2025-08-10 17:08:07,141 - utils.data_split - INFO - 📊 Dataset split completed:
2025-08-10 17:08:07,142 - utils.data_split - INFO -    Train: 19 samples
2025-08-10 17:08:07,143 - utils.data_split - INFO -    Test: 5 samples
2025-08-10 17:08:07,172 - utils.data_split - INFO -    Train class balance: 21.1% positive
2025-08-10 17:08:07,199 - utils.data_split - INFO -    Test class balance: 20.0% positive
2025-08-10 17:08:07,250 - utils.data_split - INFO - ✅ Balanced test set: 20.0% positive
2025-08-10 17:08:07,252 - __main__ - INFO -    Quick REAL LIGO samples: train=19, test=5
2025-08-10 17:08:07,253 - __main__ - INFO - ⏳ Starting real training loop...
2025-08-10 17:08:07,254 - __main__ - INFO -    Training data shape: (19, 256)
2025-08-10 17:08:07,255 - __main__ - INFO -    Labels shape: (19,)
2025-08-10 17:08:07,256 - __main__ - INFO -    Running 2 epochs...
2025-08-10 17:08:07,257 - __main__ - INFO - 🚀 Starting REAL CPC+SNN training pipeline!
2025-08-10 17:08:07,275 - training.training_utils - INFO - JAX devices: [CpuDevice(id=0)]
2025-08-10 17:08:07,275 - training.training_utils - INFO - JAX devices: [CpuDevice(id=0)]
2025-08-10 17:08:07,276 - training.training_utils - INFO - JAX platform: cpu
2025-08-10 17:08:07,276 - training.training_utils - INFO - JAX platform: cpu
2025-08-10 17:08:07,277 - training.base_trainer - INFO - Using basic experiment tracker
2025-08-10 17:08:07,277 - training.base_trainer - INFO - Using basic experiment tracker
2025-08-10 17:08:07,282 - training.training_utils - INFO - Configuration saved to outputs/sanity_2ep_cpu_fast/standard_training_1bs/config.json
2025-08-10 17:08:07,282 - training.training_utils - INFO - Configuration saved to outputs/sanity_2ep_cpu_fast/standard_training_1bs/config.json
2025-08-10 17:08:07,284 - training.base_trainer - INFO - Initialized CPCSNNTrainer with config: cpc_snn_gw
2025-08-10 17:08:07,284 - training.base_trainer - INFO - Initialized CPCSNNTrainer with config: cpc_snn_gw
2025-08-10 17:08:19,459 - __main__ - INFO - ⚡ Quick-mode: disabling Orbax checkpoint managers
2025-08-10 17:08:19,459 - __main__ - INFO - ⚡ Quick-mode: disabling Orbax checkpoint managers
2025-08-10 17:08:19,461 - __main__ - INFO -    🔥 Epoch 1/2
2025-08-10 17:08:19,461 - __main__ - INFO -    🔥 Epoch 1/2
2025-08-10 17:11:33,244 - __main__ - INFO -       Step 10/19 loss=0.4013 acc=1.000 | MA20: loss=0.5806 acc=0.700
2025-08-10 17:11:33,244 - __main__ - INFO -       Step 10/19 loss=0.4013 acc=1.000 | MA20: loss=0.5806 acc=0.700
2025-08-10 17:13:55,318 - __main__ - INFO -       Loss: 0.6178, Accuracy: 0.6842
2025-08-10 17:13:55,318 - __main__ - INFO -       Loss: 0.6178, Accuracy: 0.6842
2025-08-10 17:14:07,079 - __main__ - INFO -       Test acc=0.800 | sens=0.000 spec=1.000 prec=0.000 f1=0.000 bal_acc=0.500
2025-08-10 17:14:07,079 - __main__ - INFO -       Test acc=0.800 | sens=0.000 spec=1.000 prec=0.000 f1=0.000 bal_acc=0.500
2025-08-10 17:14:07,088 - training.training_metrics - INFO - New best balanced_accuracy: 0.500000 at epoch 0
2025-08-10 17:14:07,088 - training.training_metrics - INFO - New best balanced_accuracy: 0.500000 at epoch 0
2025-08-10 17:14:07,095 - __main__ - INFO -       🏆 New best balanced accuracy; saving best checkpoint
2025-08-10 17:14:07,095 - __main__ - INFO -       🏆 New best balanced accuracy; saving best checkpoint
2025-08-10 17:14:07,097 - __main__ - INFO -    🔥 Epoch 2/2
2025-08-10 17:14:07,097 - __main__ - INFO -    🔥 Epoch 2/2
2025-08-10 17:16:45,292 - __main__ - INFO -       Step 10/19 loss=0.9911 acc=0.000 | MA20: loss=0.7870 acc=0.500
2025-08-10 17:16:45,292 - __main__ - INFO -       Step 10/19 loss=0.9911 acc=0.000 | MA20: loss=0.7870 acc=0.500
2025-08-10 17:19:09,797 - __main__ - INFO -       Loss: 0.8490, Accuracy: 0.4737
2025-08-10 17:19:09,797 - __main__ - INFO -       Loss: 0.8490, Accuracy: 0.4737
2025-08-10 17:19:10,617 - __main__ - INFO -       Test acc=0.800 | sens=0.000 spec=1.000 prec=0.000 f1=0.000 bal_acc=0.500
2025-08-10 17:19:10,617 - __main__ - INFO -       Test acc=0.800 | sens=0.000 spec=1.000 prec=0.000 f1=0.000 bal_acc=0.500
2025-08-10 17:19:10,630 - __main__ - INFO - 🎉 REAL Training completed in 663.4s!
2025-08-10 17:19:10,630 - __main__ - INFO - 🎉 REAL Training completed in 663.4s!
2025-08-10 17:19:10,631 - training.test_evaluation - INFO - 
🧪 Evaluating on test set...
2025-08-10 17:19:10,631 - training.test_evaluation - INFO - 
🧪 Evaluating on test set...
2025-08-10 17:19:11,981 - training.test_evaluation - INFO - 📊 TEST SET ANALYSIS:
2025-08-10 17:19:11,981 - training.test_evaluation - INFO - 📊 TEST SET ANALYSIS:
2025-08-10 17:19:11,982 - training.test_evaluation - INFO -    Test samples: 5
2025-08-10 17:19:11,982 - training.test_evaluation - INFO -    Test samples: 5
2025-08-10 17:19:11,984 - training.test_evaluation - INFO -    True labels - Class 0: 4, Class 1: 1
2025-08-10 17:19:11,984 - training.test_evaluation - INFO -    True labels - Class 0: 4, Class 1: 1
2025-08-10 17:19:11,985 - training.test_evaluation - INFO -    Predictions - Class 0: 5, Class 1: 0
2025-08-10 17:19:11,985 - training.test_evaluation - INFO -    Predictions - Class 0: 5, Class 1: 0
2025-08-10 17:19:11,987 - training.test_evaluation - INFO -    Test accuracy: 80.0%
2025-08-10 17:19:11,987 - training.test_evaluation - INFO -    Test accuracy: 80.0%
2025-08-10 17:19:11,991 - training.test_evaluation - WARNING - 🚨 MODEL ALWAYS PREDICTS CLASS 0 ON TEST SET!
2025-08-10 17:19:11,991 - training.test_evaluation - WARNING - 🚨 MODEL ALWAYS PREDICTS CLASS 0 ON TEST SET!
2025-08-10 17:19:11,992 - training.test_evaluation - WARNING -    This suggests the model didn't learn properly
2025-08-10 17:19:11,992 - training.test_evaluation - WARNING -    This suggests the model didn't learn properly
2025-08-10 17:19:11,994 - training.test_evaluation - INFO - 🔍 TEST PREDICTIONS vs LABELS:
2025-08-10 17:19:11,994 - training.test_evaluation - INFO - 🔍 TEST PREDICTIONS vs LABELS:
2025-08-10 17:19:12,070 - training.test_evaluation - INFO -    Test 0: Pred=0, True=0 ✅
2025-08-10 17:19:12,070 - training.test_evaluation - INFO -    Test 0: Pred=0, True=0 ✅
2025-08-10 17:19:12,074 - training.test_evaluation - INFO -    Test 1: Pred=0, True=0 ✅
2025-08-10 17:19:12,074 - training.test_evaluation - INFO -    Test 1: Pred=0, True=0 ✅
2025-08-10 17:19:12,077 - training.test_evaluation - INFO -    Test 2: Pred=0, True=0 ✅
2025-08-10 17:19:12,077 - training.test_evaluation - INFO -    Test 2: Pred=0, True=0 ✅
2025-08-10 17:19:12,079 - training.test_evaluation - INFO -    Test 3: Pred=0, True=1 ❌
2025-08-10 17:19:12,079 - training.test_evaluation - INFO -    Test 3: Pred=0, True=1 ❌
2025-08-10 17:19:12,082 - training.test_evaluation - INFO -    Test 4: Pred=0, True=0 ✅
2025-08-10 17:19:12,082 - training.test_evaluation - INFO -    Test 4: Pred=0, True=0 ✅
2025-08-10 17:19:12,085 - __main__ - INFO - ======================================================================
🧪 TEST EVALUATION SUMMARY 🧪
======================================================================
Training Accuracy: 47.4%
Test Accuracy: 80.0% (This is the REAL accuracy!)
🔬 Good performance - verify results!
🚨 MODEL COLLAPSE: Always predicts class 0
Data Source: Real LIGO GW150914
Epochs: 2
======================================================================
2025-08-10 17:19:12,085 - __main__ - INFO - ======================================================================
🧪 TEST EVALUATION SUMMARY 🧪
======================================================================
Training Accuracy: 47.4%
Test Accuracy: 80.0% (This is the REAL accuracy!)
🔬 Good performance - verify results!
🚨 MODEL COLLAPSE: Always predicts class 0
Data Source: Real LIGO GW150914
Epochs: 2
======================================================================
2025-08-10 17:19:12,088 - __main__ - INFO - 🎉 Training completed successfully!
2025-08-10 17:19:12,088 - __main__ - INFO - 🎉 Training completed successfully!
2025-08-10 17:19:12,090 - __main__ - INFO -    - Total epochs: 2
2025-08-10 17:19:12,090 - __main__ - INFO -    - Total epochs: 2
2025-08-10 17:19:12,091 - __main__ - INFO -    - Final loss: 0.8490
2025-08-10 17:19:12,091 - __main__ - INFO -    - Final loss: 0.8490
2025-08-10 17:19:12,092 - __main__ - INFO -    - Training accuracy: 0.4737
2025-08-10 17:19:12,092 - __main__ - INFO -    - Training accuracy: 0.4737
2025-08-10 17:19:12,094 - __main__ - INFO -    - Test accuracy: 0.8000 (REAL accuracy)
2025-08-10 17:19:12,094 - __main__ - INFO -    - Test accuracy: 0.8000 (REAL accuracy)
2025-08-10 17:19:12,095 - __main__ - INFO -    - Training time: 663.4s
2025-08-10 17:19:12,095 - __main__ - INFO -    - Training time: 663.4s
2025-08-10 17:19:12,098 - __main__ - INFO -    Model saved to: /mnt/c/Users/alpph/Documents/CPC-SNN-GW/outputs/sanity_2ep_cpu_fast/standard_training_1bs/final_model.orbax
2025-08-10 17:19:12,098 - __main__ - INFO -    Model saved to: /mnt/c/Users/alpph/Documents/CPC-SNN-GW/outputs/sanity_2ep_cpu_fast/standard_training_1bs/final_model.orbax
2025-08-10 17:19:12,131 - __main__ - INFO - ✅ Training completed successfully!
2025-08-10 17:19:12,131 - __main__ - INFO - ✅ Training completed successfully!
2025-08-10 17:19:12,135 - __main__ - INFO - 📊 Final metrics: {'final_train_loss': 0.8489533474570826, 'final_train_accuracy': 0.47368421052631576, 'final_test_accuracy': 0.800000011920929, 'final_val_loss': None, 'final_val_accuracy': None, 'total_epochs': 2, 'total_steps': 38, 'best_metric': 0.800000011920929, 'training_time_seconds': 663.3725111484528, 'model_params': 250000, 'has_proper_test_set': True, 'model_collapse': True, 'test_analysis': {'test_accuracy': 0.800000011920929, 'has_proper_test_set': True, 'data_leakage': False, 'model_collapse': True, 'collapsed_class': 0, 'class_counts_true': {0: 4, 1: 1}, 'class_counts_pred': {0: 5, 1: 0}, 'suspicious_patterns': ['model_collapse'], 'sensitivity': 0.0, 'specificity': 1.0, 'precision': 0.0, 'recall': 0.0, 'f1_score': 0.0, 'predictions': [0, 0, 0, 0, 0], 'true_labels': [0, 0, 0, 1, 0], 'probabilities': [0.07726236432790756, 0.05582796782255173, 0.07798897475004196, 0.058377455919981, 0.04372261092066765], 'auc_roc': 0.0, 'auc_pr': 0.0, 'roc_curve': {}, 'pr_curve': {}, 'opt_threshold': 0.5, 'ece': 0.19946466758847237, 'event_level': {}}}
2025-08-10 17:19:12,135 - __main__ - INFO - 📊 Final metrics: {'final_train_loss': 0.8489533474570826, 'final_train_accuracy': 0.47368421052631576, 'final_test_accuracy': 0.800000011920929, 'final_val_loss': None, 'final_val_accuracy': None, 'total_epochs': 2, 'total_steps': 38, 'best_metric': 0.800000011920929, 'training_time_seconds': 663.3725111484528, 'model_params': 250000, 'has_proper_test_set': True, 'model_collapse': True, 'test_analysis': {'test_accuracy': 0.800000011920929, 'has_proper_test_set': True, 'data_leakage': False, 'model_collapse': True, 'collapsed_class': 0, 'class_counts_true': {0: 4, 1: 1}, 'class_counts_pred': {0: 5, 1: 0}, 'suspicious_patterns': ['model_collapse'], 'sensitivity': 0.0, 'specificity': 1.0, 'precision': 0.0, 'recall': 0.0, 'f1_score': 0.0, 'predictions': [0, 0, 0, 0, 0], 'true_labels': [0, 0, 0, 1, 0], 'probabilities': [0.07726236432790756, 0.05582796782255173, 0.07798897475004196, 0.058377455919981, 0.04372261092066765], 'auc_roc': 0.0, 'auc_pr': 0.0, 'roc_curve': {}, 'pr_curve': {}, 'opt_threshold': 0.5, 'ece': 0.19946466758847237, 'event_level': {}}}
2025-08-10 17:19:12,138 - __main__ - INFO - 💾 Model saved to: /mnt/c/Users/alpph/Documents/CPC-SNN-GW/outputs/sanity_2ep_cpu_fast/standard_training_1bs/final_model.orbax
2025-08-10 17:19:12,138 - __main__ - INFO - 💾 Model saved to: /mnt/c/Users/alpph/Documents/CPC-SNN-GW/outputs/sanity_2ep_cpu_fast/standard_training_1bs/final_model.orbax

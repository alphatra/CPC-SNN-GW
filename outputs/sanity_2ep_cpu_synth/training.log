[2025-08-10 17:37:56,745] INFO [__main__:1030] Forcing CPU backend as requested by --device=cpu
[2025-08-10 17:37:56,746] INFO [__main__:1048] üöÄ Starting CPC+SNN training (v0.1.dev2+g95217e9.d20250716)
[2025-08-10 17:37:56,747] INFO [__main__:1049]    Output directory: outputs/sanity_2ep_cpu_synth
[2025-08-10 17:37:56,747] INFO [__main__:1050]    Configuration: configs/final_framework_config.yaml
[2025-08-10 17:37:56,748] INFO [__main__:1053] üîß Configuring JAX GPU settings...
[2025-08-10 17:37:56,766] INFO [__main__:1059] üîß Applying performance optimizations (startup)
[2025-08-10 17:37:56,767] INFO [utils.config:36] ‚úÖ Applying runtime performance optimizations...
[2025-08-10 17:37:59,018] ERROR [jax._src.xla_bridge:502] Jax plugin configuration error: Exception when calling jax_plugins.xla_cuda12.initialize()
Traceback (most recent call last):
  File "/mnt/c/Users/alpph/Documents/CPC-SNN-GW/.venv/lib/python3.12/site-packages/jax/_src/xla_bridge.py", line 500, in discover_pjrt_plugins
    plugin_module.initialize()
  File "/mnt/c/Users/alpph/Documents/CPC-SNN-GW/.venv/lib/python3.12/site-packages/jax_plugins/xla_cuda12/__init__.py", line 328, in initialize
    _check_cuda_versions(raise_on_first_error=True)
  File "/mnt/c/Users/alpph/Documents/CPC-SNN-GW/.venv/lib/python3.12/site-packages/jax_plugins/xla_cuda12/__init__.py", line 285, in _check_cuda_versions
    local_device_count = cuda_versions.cuda_device_count()
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: jaxlib/cuda/versions_helpers.cc:113: operation cuInit(0) failed: CUDA_ERROR_NO_DEVICE
[2025-08-10 17:37:59,084] WARNING [jax._src.xla_bridge:872] An NVIDIA GPU may be present on this machine, but a CUDA-enabled jaxlib is not installed. Falling back to cpu.
[2025-08-10 17:37:59,085] INFO [utils.config:60] JAX platform: cpu
[2025-08-10 17:37:59,085] INFO [utils.config:61] JAX devices: [CpuDevice(id=0)]
[2025-08-10 17:37:59,086] INFO [utils.config:62] Memory fraction: 0.35
[2025-08-10 17:37:59,086] INFO [utils.config:68] System memory: 16.7GB total, 15.8GB available
[2025-08-10 17:37:59,087] INFO [__main__:1064] üîß Pre-compiling models (startup)
[2025-08-10 17:37:59,087] INFO [utils.config:114] ‚è≠Ô∏è Skipping JIT pre-compilation on dummy inputs (user preference)
[2025-08-10 17:37:59,088] INFO [__main__:1088] ‚è≠Ô∏è Skipping GPU warmup (device is not GPU)
[2025-08-10 17:37:59,088] INFO [__main__:1203]    Continuing with default JAX settings
[2025-08-10 17:37:59,109] INFO [utils.config:444] Adding default enhanced W&B configuration
[2025-08-10 17:37:59,110] INFO [utils.config:447] Loaded configuration from configs/final_framework_config.yaml
[2025-08-10 17:37:59,111] INFO [__main__:1212] ‚úÖ Loaded configuration from configs/final_framework_config.yaml
[2025-08-10 17:37:59,124] INFO [utils.config:479] Configuration saved to outputs/sanity_2ep_cpu_synth/config.yaml
[2025-08-10 17:37:59,125] INFO [__main__:1251] üíæ Saved configuration to outputs/sanity_2ep_cpu_synth/config.yaml
[2025-08-10 17:37:59,126] INFO [__main__:1255] üéØ Starting standard training mode...
[2025-08-10 17:37:59,127] INFO [__main__:1262] üìã Configuration loaded: cpu device, 128 latent dim
[2025-08-10 17:37:59,128] INFO [__main__:1263] üìã Spike encoding: phase_preserving
[2025-08-10 17:37:59,128] INFO [__main__:1264] üìã SNN hidden size: 512
[2025-08-10 17:37:59,129] INFO [__main__:1271] üîß Running standard CPC+SNN training...
[2025-08-10 17:37:59,141] INFO [utils.device_auto_detection:201] üîç Starting intelligent device detection...
[2025-08-10 17:37:59,143] INFO [utils.device_auto_detection:51] PyTorch not available for GPU detection
[2025-08-10 17:37:59,144] INFO [utils.device_auto_detection:62] JAX devices detected: [CpuDevice(id=0)]
[2025-08-10 17:37:59,144] INFO [utils.device_auto_detection:123] üîã STANDARD CPU: 16 cores, 15.6GB RAM
[2025-08-10 17:37:59,145] INFO [utils.device_auto_detection:137] üîß Applying optimal device configuration...
[2025-08-10 17:37:59,145] INFO [utils.device_auto_detection:138]    Platform: cpu
[2025-08-10 17:37:59,146] INFO [utils.device_auto_detection:139]    Memory fraction: 0.4
[2025-08-10 17:37:59,147] INFO [utils.device_auto_detection:140]    Recommended batch size: 1
[2025-08-10 17:37:59,147] INFO [utils.device_auto_detection:141]    Expected speedup: 1.0x
[2025-08-10 17:37:59,148] INFO [utils.device_auto_detection:162] ‚úÖ JAX configured successfully:
[2025-08-10 17:37:59,148] INFO [utils.device_auto_detection:163]    Platform: cpu
[2025-08-10 17:37:59,149] INFO [utils.device_auto_detection:164]    Devices: [CpuDevice(id=0)]
[2025-08-10 17:37:59,149] INFO [utils.device_auto_detection:169] üíª CPU mode active - Consider GPU for 1.0x speedup
[2025-08-10 17:37:59,150] INFO [utils.device_auto_detection:215] ‚úÖ Device auto-detection and optimization complete!
[2025-08-10 17:37:59,151] INFO [utils.device_auto_detection:216] üí° TIP: Your system is optimized for CPU training
[2025-08-10 17:37:59,151] INFO [__main__:63] üéÆ Platform detected: CPU
[2025-08-10 17:37:59,152] INFO [__main__:64] ‚ö° Expected speedup: 1.0x
[2025-08-10 17:37:59,154] INFO [__main__:91] üîß Real CPC+SNN training pipeline:
[2025-08-10 17:37:59,155] INFO [__main__:99]    - CPC Latent Dim: 128
[2025-08-10 17:37:59,155] INFO [__main__:100]    - Batch Size: 1
[2025-08-10 17:37:59,156] INFO [__main__:101]    - Learning Rate: 0.001
[2025-08-10 17:37:59,157] INFO [__main__:102]    - Epochs: 2
[2025-08-10 17:37:59,157] INFO [__main__:103]    - Spike Encoding: phase_preserving
[2025-08-10 17:37:59,170] INFO [training.training_utils:90] JAX devices: [CpuDevice(id=0)]
[2025-08-10 17:37:59,171] INFO [training.training_utils:91] JAX platform: cpu
[2025-08-10 17:37:59,173] INFO [training.base_trainer:170] Using basic experiment tracker
[2025-08-10 17:37:59,179] INFO [training.training_utils:116] Configuration saved to outputs/sanity_2ep_cpu_synth/standard_training_1bs/config.json
[2025-08-10 17:37:59,180] INFO [training.base_trainer:193] Initialized CPCSNNTrainer with config: cpc_snn_gw
[2025-08-10 17:37:59,786] INFO [__main__:108] üöÄ Creating CPC+SNN model with SpikeBridge...
[2025-08-10 17:37:59,788] INFO [__main__:111] üìä Creating data loaders...
[2025-08-10 17:37:59,800] WARNING [data.gw_dataset_builder:29] TensorFlow not available - TFRecord export disabled
[2025-08-10 17:37:59,802] INFO [__main__:119]    Creating REAL LIGO dataset with GW150914 data...
[2025-08-10 17:37:59,822] INFO [data.real_ligo_integration:251] üöÄ Creating ENHANCED dataset with 2000 target samples
[2025-08-10 17:37:59,823] INFO [data.real_ligo_integration:252]    Enhanced overlap: 90.0%
[2025-08-10 17:37:59,823] INFO [data.real_ligo_integration:253]    Data augmentation: True
[2025-08-10 17:37:59,825] WARNING [data.real_ligo_integration:41] ‚ùå ReadLIGO loading failed: ModuleNotFoundError: No module named 'readligo'
[2025-08-10 17:37:59,829] INFO [data.real_ligo_integration:50] ‚úÖ Using h5py fallback - loading LOSC HDF5 files directly
[2025-08-10 17:37:59,939] INFO [data.real_ligo_integration:91] ‚úÖ Successfully loaded real GW150914 strain data (source=h5py): 2048 samples
[2025-08-10 17:37:59,940] INFO [data.real_ligo_integration:92] üìä Strain amplitude range: -7.60e-21 to -2.08e-21
[2025-08-10 17:37:59,943] INFO [data.real_ligo_integration:261] üì° Processing real LIGO data with enhanced windowing...
[2025-08-10 17:37:59,959] INFO [data.real_ligo_integration:270] ‚úÖ Real LIGO windows: 31 (vs previous ~15)
[2025-08-10 17:38:00,295] INFO [data.real_ligo_integration:276] üîÑ Applying data augmentation to real LIGO data...
[2025-08-10 17:38:00,773] INFO [data.real_ligo_integration:289] ‚úÖ Augmented data: +155 samples
[2025-08-10 17:38:00,783] INFO [data.real_ligo_integration:319] üîÑ Generating 1814 synthetic GW samples...
[2025-08-10 17:38:06,821] INFO [data.real_ligo_integration:364] üéØ ENHANCED DATASET CREATED:
[2025-08-10 17:38:06,822] INFO [data.real_ligo_integration:365]    Total samples: 2000
[2025-08-10 17:38:06,824] INFO [data.real_ligo_integration:366]    Window size: 512
[2025-08-10 17:38:06,892] INFO [data.real_ligo_integration:367]    GW signals: 729 (36.5%)
[2025-08-10 17:38:06,919] INFO [data.real_ligo_integration:368]    Noise samples: 1271 (63.6%)
[2025-08-10 17:38:07,734] INFO [utils.data_split:49] üìä Creating stratified split (train: 80.0%):
[2025-08-10 17:38:07,735] INFO [utils.data_split:50]    Class 0 samples: 1271
[2025-08-10 17:38:07,736] INFO [utils.data_split:51]    Class 1 samples: 729
[2025-08-10 17:38:09,147] INFO [utils.data_split:90] üìä Dataset split completed:
[2025-08-10 17:38:09,148] INFO [utils.data_split:91]    Train: 1599 samples
[2025-08-10 17:38:09,149] INFO [utils.data_split:92]    Test: 401 samples
[2025-08-10 17:38:09,187] INFO [utils.data_split:93]    Train class balance: 36.5% positive
[2025-08-10 17:38:09,222] INFO [utils.data_split:94]    Test class balance: 36.4% positive
[2025-08-10 17:38:09,299] INFO [utils.data_split:105] ‚úÖ Balanced test set: 36.4% positive
[2025-08-10 17:38:09,300] INFO [__main__:184]    Enhanced REAL LIGO samples: train=1599, test=401
[2025-08-10 17:38:09,301] INFO [__main__:205] ‚è≥ Starting real training loop...
[2025-08-10 17:38:09,302] INFO [__main__:210]    Training data shape: (1599, 512)
[2025-08-10 17:38:09,303] INFO [__main__:211]    Labels shape: (1599,)
[2025-08-10 17:38:09,303] INFO [__main__:212]    Running 2 epochs...
[2025-08-10 17:38:09,304] INFO [__main__:217] üöÄ Starting REAL CPC+SNN training pipeline!
[2025-08-10 17:38:09,323] INFO [training.training_utils:90] JAX devices: [CpuDevice(id=0)]
[2025-08-10 17:38:09,324] INFO [training.training_utils:91] JAX platform: cpu
[2025-08-10 17:38:09,326] INFO [training.base_trainer:170] Using basic experiment tracker
[2025-08-10 17:38:09,331] INFO [training.training_utils:116] Configuration saved to outputs/sanity_2ep_cpu_synth/standard_training_1bs/config.json
[2025-08-10 17:38:09,333] INFO [training.base_trainer:193] Initialized CPCSNNTrainer with config: cpc_snn_gw
[2025-08-10 17:38:21,695] INFO [__main__:291] ‚ö° Quick-mode: disabling Orbax checkpoint managers
[2025-08-10 17:38:21,697] INFO [__main__:296]    üî• Epoch 1/2
[2025-08-10 17:42:01,499] INFO [__main__:333]       Step 10/100 loss=0.6215 acc=0.000 | MA20: loss=0.7119 acc=0.500
[2025-08-10 17:44:56,667] INFO [__main__:333]       Step 20/100 loss=0.4608 acc=1.000 | MA20: loss=0.6786 acc=0.550
[2025-08-10 17:47:53,544] INFO [__main__:333]       Step 30/100 loss=0.5465 acc=1.000 | MA20: loss=1.0142 acc=0.400
[2025-08-10 17:50:48,907] INFO [__main__:333]       Step 40/100 loss=1.0828 acc=0.000 | MA20: loss=1.0405 acc=0.350
[2025-08-10 17:53:46,675] INFO [__main__:333]       Step 50/100 loss=0.7696 acc=0.000 | MA20: loss=0.8142 acc=0.450
[2025-08-10 17:56:43,705] INFO [__main__:333]       Step 60/100 loss=0.4859 acc=1.000 | MA20: loss=0.9288 acc=0.500
[2025-08-10 17:59:42,448] INFO [__main__:333]       Step 70/100 loss=0.4248 acc=1.000 | MA20: loss=0.8475 acc=0.550
[2025-08-10 18:02:40,123] INFO [__main__:333]       Step 80/100 loss=0.4191 acc=1.000 | MA20: loss=0.8012 acc=0.450
[2025-08-10 18:05:37,086] INFO [__main__:333]       Step 90/100 loss=0.6372 acc=0.000 | MA20: loss=0.7639 acc=0.400
[2025-08-10 18:08:35,039] INFO [__main__:333]       Step 100/100 loss=0.5716 acc=1.000 | MA20: loss=0.6488 acc=0.600
[2025-08-10 18:08:35,042] INFO [__main__:340]       Loss: 0.8196, Accuracy: 0.4900
[2025-08-10 18:09:24,678] INFO [__main__:382]       Test acc=0.626 | sens=0.151 spec=0.898 prec=0.458 f1=0.227 bal_acc=0.524
[2025-08-10 18:09:24,688] INFO [training.training_metrics:328] New best balanced_accuracy: 0.524362 at epoch 0
[2025-08-10 18:09:24,695] INFO [__main__:481]       üèÜ New best balanced accuracy; saving best checkpoint
[2025-08-10 18:09:24,696] INFO [__main__:296]    üî• Epoch 2/2
[2025-08-10 18:12:21,395] INFO [__main__:333]       Step 10/100 loss=0.5499 acc=1.000 | MA20: loss=0.5533 acc=0.800
[2025-08-10 18:15:21,196] INFO [__main__:333]       Step 20/100 loss=0.5039 acc=1.000 | MA20: loss=0.6599 acc=0.700
[2025-08-10 18:18:25,778] INFO [__main__:333]       Step 30/100 loss=0.5630 acc=1.000 | MA20: loss=0.7487 acc=0.500
[2025-08-10 18:21:28,932] INFO [__main__:333]       Step 40/100 loss=0.6775 acc=0.000 | MA20: loss=0.7145 acc=0.400
[2025-08-10 18:24:30,569] INFO [__main__:333]       Step 50/100 loss=1.3338 acc=0.000 | MA20: loss=0.7489 acc=0.450
[2025-08-10 18:27:37,126] INFO [__main__:333]       Step 60/100 loss=0.4522 acc=1.000 | MA20: loss=0.7935 acc=0.500
[2025-08-10 18:30:45,626] INFO [__main__:333]       Step 70/100 loss=1.0674 acc=0.000 | MA20: loss=0.8456 acc=0.350
[2025-08-10 18:33:52,697] INFO [__main__:333]       Step 80/100 loss=0.5149 acc=1.000 | MA20: loss=0.8323 acc=0.450
[2025-08-10 18:37:02,021] INFO [__main__:333]       Step 90/100 loss=1.0024 acc=0.000 | MA20: loss=0.7071 acc=0.650
[2025-08-10 18:40:12,675] INFO [__main__:333]       Step 100/100 loss=0.4458 acc=1.000 | MA20: loss=0.7061 acc=0.650
[2025-08-10 18:40:12,682] INFO [__main__:340]       Loss: 0.7413, Accuracy: 0.5400
[2025-08-10 18:40:33,658] INFO [__main__:382]       Test acc=0.369 | sens=0.986 spec=0.016 prec=0.365 f1=0.532 bal_acc=0.501
[2025-08-10 18:40:33,677] INFO [__main__:508] üéâ REAL Training completed in 3744.4s!
[2025-08-10 18:40:33,679] INFO [training.test_evaluation:51] 
üß™ Evaluating on test set...
